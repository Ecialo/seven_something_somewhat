- !new_action
  name: LoadBullet
  action_type: FULL
  speed: NORMAL
  cost: 1
  setup: []
  effects:
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: loaded
        value: "bullet"
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: AddAction
        extra_tags: ["plan"]
        action_name: Shoot
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: AddAction
        extra_tags: ["plan"]
        action_name: ReadyBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr [!prop owner.bullets, ">", 0]
  widget:
    icon: './data/units/fighter_rifle/bullet.png'
    pressed_icon: './data/units/fighter_rifle/bullet_pressed.png'

- !new_action
  name: LoadBuckshot
  action_type: FULL
  speed: NORMAL
  cost: 1
  setup: []
  effects:
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: loaded
        value: "buckshot"
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: AddAction
        extra_tags: ["plan"]
        action_name: Shoot
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr [!prop owner.buckshots, ">", 0]
  widget:
    icon: './data/units/fighter_rifle/buckshot.png'
    pressed_icon: './data/units/fighter_rifle/buckshot_pressed.png'

- !new_action
  name: ShootBullet
  action_type: STANDARD
  speed: SLOW
  cost: 1
  setup:
    - name: target
      cursor: geometry_last
      cursor_params:
        - !area
          name: Ring
          center: !prop source
          inner_radius: 1
          radius: 5
        - !area
          name: Ray
          source: !prop source
          target: !prop selected
          length: 5
  effects:
    - effect: !eff
        name: Damage
        amount: 35
      area: !area
        name: Ray
        source: !prop source
        target: !prop action.target
        length: 5
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: loaded
        value: "nothing"
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: bullets
        value: !expr [!prop owner.bullets, "-", 1]
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ShootBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ReadyBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr [!prop owner.loaded, "==", "bullet"]
  widget:
    icon: './data/units/fighter_rifle/gunshot.png'
    pressed_icon: './data/units/fighter_rifle/gunshot_pressed.png'

- !new_action
  name: ShootTestBullet
  action_type: STANDARD
  speed: SLOW
  cost: 1
  setup:
    - name: target
      cursor: geometry_last
      cursor_params:
        - !area
          name: Ring
          center: !prop source
          inner_radius: 1
          radius: 5
        - !area
          name: Ray
          source: !prop source
          target: !prop selected
          length: 5
  effects:
    - effect: !eff
        name: TestShoot
      area: !area
        name: Ray
        source: !prop source
        target: !prop action.target
        length: 5
  widget:
    icon: './data/units/fighter_rifle/gunshot.png'
    pressed_icon: './data/units/fighter_rifle/gunshot_pressed.png'


- !new_action
  name: ReadyBullet
  action_type: STANDARD
  speed: SLOW
  cost: 1
  setup:
    - name: target
      cursor: geometry
      cursor_params:
        - !area
          name: Ring
          center: !prop source
          inner_radius: 1
          radius: 5
        - !area
          name: Cone60
          source: !prop source
          target: !prop selected
          length: 5
  effects:
    - effect: !eff
        name: AddStatus
        extra_tags: ["plan"]
        status: !status
          name: ReadyToShoot
          shoot_target: !prop action.target
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: endurance
        value: !expr [!prop owner.endurance, "-", 1]
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ReadyBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ShootBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr
    - [!prop owner.endurance, ">", 0]
    - and
    - [!prop owner.loaded, "==", "bullet"]
  widget:
    icon: './data/units/fighter_rifle/crosshair.png'
    pressed_icon: './data/units/fighter_rifle/crosshair_pressed.png'

- !new_action
  name: ShootBuckshot
  action_type: STANDARD
  speed: SLOW
  cost: 1
  setup:
    - name: target
      cursor: geometry_last
      cursor_params:
        - !area
          name: Ring
          center: !prop source
          inner_radius: 1
          radius: 5
        - !area
          name: Ray
          source: !prop source
          target: !prop selected
          length: 5
  effects:
    - effect: !eff
        name: BuckshotDamage
        line_of_fire: !area
          name: Ray
          source: !prop source
          target: !prop action.target
          length: 5
      area: !area
        name: Ray
        source: !prop source
        target: !prop action.target
        length: 5
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: loaded
        value: "nothing"
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: ChangeStat
        extra_tags: ["plan"]
        stat_name: buckshots
        value: !expr [!prop owner.buckshots, "-", 1]
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ShootBuckshot
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr [!prop owner.loaded, "==", "buckshot"]
  widget:
    icon: './data/units/fighter_rifle/gunshot.png'
    pressed_icon: './data/units/fighter_rifle/gunshot_pressed.png'

- !new_action
  name: Shoot
  action_type: STANDARD
  speed: SLOW
  cost: 1
  setup:
    - name: target
      cursor: geometry_last
      cursor_params:
        - !area
          name: Ring
          center: !prop source
          inner_radius: 1
          radius: 5
        - !area
          name: Ray
          source: !prop source
          target: !prop selected
          length: 5
  effects:
    - effect: !eff
        name: ShootLoaded
      area: !area
        name: Ray
        source: !prop source
        target: !prop action.target
        length: 5
    - effect: !eff
        name: RemoveLoaded
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: Shoot
      area: !area
        name: Cell
        cell: !prop owner.cell
    - effect: !eff
        name: RemoveAction
        extra_tags: ["plan"]
        action_name: ReadyBullet
      area: !area
        name: Cell
        cell: !prop owner.cell
  check: !expr [!prop owner.loaded, "!=", "nothing"]
  widget:
    icon: './data/units/fighter_rifle/gunshot.png'
    pressed_icon: './data/units/fighter_rifle/gunshot_pressed.png'