- !new_eff
  name: Fatigue
  params:
    - amount
  effects:
    - effect: !eff
        name: Damage
        amount: 10
    - effect: !eff
        name: ChangeStat
        stat_name: action_points
        value: !expr [!prop target.action_points, '-', !prop effect.amount]
      condition: !expr [!prop target.action_points, '>=', !prop effect.amount]

- !new_eff
  name: TestParry
  type: meta
  params:
    - power
  effects:
    - effect: !eff
        name: Redirect
        target: !prop incoming_effect_context.source
      condition: !expr
        - !prop effect.power
        - '>='
        - [!prop incoming_effect.amount, '*', 2]
    - effect: !eff
        name: Discard
      condition: !expr [!prop effect.power, '>=', !prop incoming_effect.amount]
      
- !new_eff
  name: Skushat
  params: []
  effects:
    - effect: !eff
        name: ChangeStat
        stat_name: health
#        value: !expr [!prop owner.health, '+', !prop target_context.victim.max__health]
        value: !expr [!prop owner.health, '+', !prop event_effect_victim.max__health]
#      condition: !expr [!prop killer, '==', !prop owner]

- !new_eff
  name: Stun
  extra_tags: ["debuff"]
  params:
    - power
  effects:
    - effect: !eff
        name: AddStatus
        status: !status
          name: ResidualStun
          power: !expr [!prop effect.power, "-", !prop target.action_points]
      condition: !expr [!prop target.action_points, "<", !prop effect.power]
    - effect: !eff
        name: ChangeStat
        stat_name: action_points
        value: 0
      condition: !expr [!prop target.action_points, "<", !prop effect.power]
    - effect: !eff
        name: ChangeStat
        stat_name: action_points
        value: !expr [!prop target.action_points, "-", !prop effect.power]
      condition: !expr [!prop target.action_points, ">=", !prop effect.power]

- !new_eff
  name: RandomSummonTest
  params:
    - unit
    - amount
    - owner
  effects:
    - effect: !eff
        name: Summon
        unit: !prop effect.unit
        owner: !prop effect.owner
  area: !area
    name: Cell
    cell: !call [!prop owner.cell, "parallel_transfer", [-2, -2]]